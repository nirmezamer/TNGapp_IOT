## TNGapp_IOT
# הסבר כללי (high level)
הבעיה שאנחנו באים לפתור נוגעת להוצאות כלבים.
יש לנו 2 סוגי משתמשים:
1.	בעלי כלבים (Dog Owners) – אנשים שמעוניינים שמישהו יוציא את הכלב שלהם לטיול, וכן מעונינים להיות בבקרה על המיקום של הכלב בכל רגע נתון בטיול, דבר המאפשר להם לוודא שהטיול אכן קרה כנדרש, וכן שמי שמוציא את הכלב אינו מרמה
2.	מוציא כלבים (Dog Walkers) - אנשים שמעוניינים למצוא עבודות להוצאת כלבים, וכן מעוניינים לבצע את ההוצאה באופן האופטימלי

הרעיון המסדר שלנו הוא לייצר פלטפורמה המאפשרת סנכרון בין שני הקהלים: מוציאי הכלבים יוכלו למצוא עבודות ובמקביל בעלי הכלבים יקבלו תחושת בטחון בכל הנוגע לכך שהמשימה אכן בוצעה בהצלחה שלכלב לא נשקפה סכנה לאורך הטיול.

ה-MVP Flow כולל את התהליך המלא הבא:
1.	בעל הכלב מבצע אותנטיקציה מול השירות
2.	בעל הכלב מעלה בקשה להוצאת הכלב שלו
3.	מוציא כלבים מוצא את הבקשה ומשריין אותה
4.	לאחר שיחה ותיאום, בעל הכלב נותן למוציא הכלבים את הסיסמא לעבודה
5.	מוציא הכלבים מגיע ומאמת שהוא לוקח את הכלב על ידי שימוש בסיסמא
6.	מוציא הכלבים יוצא לטיול ובמקביל, בעל הכלב יכול לצפות במיקום של הכלב בכל רגע שירצה, ולהתעדכן אם יש חריגה מהמרחק המוגדר
7.	מוציא הכלבים מחזיר את הכלב ו"מנתק" את הקשר ביניהם


פיצ'רים שמימשנו:
1.	אותנטיקציה של כלל המשתמשים מול גוגל
2.	שימוש בToken-ים לטובת זיהוי המשתמש בכל פעולה (אין פעולות למשתמש לא מזוהה)
3.	מימוש מלא של האפליקציה ב-WEB ו-ANDROID עבור שני סוגי המשתמשים - גם Owner וגם Walker
4.	מימוש SignalR להעברת עדוכנים בין המשתמשים השונים
5.	פיצ'ר שמאפשר לבעלי כלבים להעלות בקשה לטיול
6.	פיצ'ר שמאפשר לבעל הכלב לראות את כל העבודות שביקש
7.	פיצ'ר שמאפשר למוציאי כלבים לצפות בכלל העבודות שנמצאות כרגע בשוק
8.	פיצ'ר שמאפשר למוציא הכלבים "לתפוס" עבודה לעתיד
9.	פיצ'ר שמאפשר למוציא הכלבים להתחיל את העבודה ו"לקשור" את הכלב אל המיקום שלו 
10.	ווידוא שיח בין ה-Owner ל-Walker על ידי כך שכל תחילת עבודה מעוגנת בסיסמא שנקבעה על ידי ה-Owner
11.	פיצ'ר שמאפשר לבעלי כלבים לראות את מיקום הכלב שלהם ברגע נתון עבור עבודה ספציפית (ע"י המיקום של מוציא הכלבים)
12.	פיצ'ר שמאפשר לבעל הכלב לבדוק האם הכלב נלקח למרחק רחוק מהמרחק שהוגדר
13.	פיצ'ר שמאפשר למוציאי הכלבים לסיים טיול ו"לנתק" את הכלב מהמיקום הגאוגרפי שלו
   

רשימת Services בהם השתמשנו:
1.	AzureTables – לטובת ניהול מידע טבלאי כגון סטטוס כלל העבודות המונגשות באתר
2.	SignalR – לטובת העברת אינפורציה באופן מיידי בין משתמשים שונים
3.	AzureMaps – לטובת שימוש במפות
4.	OAuthLib – לטובת ביצוע אותנטיקציה מול גוגל
5.	Geopy - לטובת אכיפת מרחק חוקי בטיול

הנחות:
1. ההתחברות היא למיילים של גוגל של אוניברסיטת תל אביב בלבד
2. הנחנו (באופן די ברור) שמוציאי הכלבים הם בעלי מכשירי mobile מסוג ANDROID שיודעים לאסוף מיקום GPS ולשדר אותו וכן שאין מוציאי כלבים שמסתובבים עם לפטופים ומבצעים את הבקשות שלהם עם לפטופ.
הנחה זו נדרשת כיוון ששירותי המיקום מתבססים על היכולת של המכשיר לבצע בקשת GPS שאינה מתאפשרת בלפטופים

איך מפעילים:
1. עושים clone לכל התיקייה של הפרויקט
2. מתקינים את כל ה-dependencies בעזרת npm install
3. לאחר מכן נכנסים לתיקיית ה-frontend ומריצים npx expo start
4. לטובת הגרסה ל-WEB לוחצים w
5. לטובת הכרסה ל-ANDROID לוחצים a (בהנחה שיש Android Studio מותקן עם מכשיר ANDROID כלשהו שכבר הופעל או מכשיר אמיתי מחובר ב-USB)
6. מבצעים אותנטיקציה עם גוגל וזהו - אתם בפנים :)


# ארכיטקטורה
האובייקט המרכזי בפלטפורמה הוא העבודות (job) כאשר בעלי הכלבים הם יוצרי העבודות ומוציאי הכלבים יכולים לשריין לעצמם ולקחת על עצמם עבודות.
עבודה מכילה מספר שדות:
1. את הפרטים הישבים שאותם מילא בעל הכלב בעת דרישת העבודה
2. את שם בעל הכלב - ע"י ה-token שלו
3. הסיסמה לעבודה - אותה מוציא הכלב יצטרך לקבל על מנת להתחיל את העבודה
4. סטטוס העבודה - יכול לקבל את הערכים הבאים:
    a. Available - מצב התחלתי
    b. Pending - מוציא כלבים שריין את העבודה
    c. Active - מוציא כלבים התחיל את ההוצאה (כרוך בהכנסת הסיסמה של העבודה)
    d. Terminate - העבודה הסתיימה
5. מיקום העבודה - המיקום של מוציא הכלבים בזמן שהעבודה (Active)
6. מיקום התחלתי
7. תקינות המיקום - ערך בולאני אשר מציין האם מוציא הכלב חרג מהתחום המותר

האפליקציה תומכת בניהול DataBase של כל העבודות שאותם כלל בעלי הכלבים מפרסמים.
בין היתר האפליקציה תומכת ב-API מלא של ניהול העבודות, כלומר הוספה/מחיקה/עדכון של העבודות השונות, כאשר לכל עבודה יש ID המזהה אותה.
במהלך ניהול עבודה של מוציא הכלב ה-API המרכזי בין ה-FE ל-BE הוא של עדכון העבודה. בפרט, כאשר מוציא הכלב ניגש לקבלת עבודה מתבצעים העדכונים הבאים:
1. שריון העבודה - הסטטוס מתעדכן ל-Pending ושם מוציא הכלב מתעדכן גם הוא לפי ה-token
2. התחלת העבודה - הסטטוס מתעדכן ל-Active בשלב זה המיקום ההתחלתי "נחתם" בעבודה ומיקום מוציא הכלב מתעדכן בזמן אמת. בנוסף, תקינות המיקום מחושבת בכל עדכון.
3. סיום העבודה - הסטטוס מתעדכן ל-Terminate והעבודה ניתנת למחיקה מהפלטפורמה.
